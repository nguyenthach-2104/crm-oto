<hr>

        <section class="filter-section">
            <h3>Lọc dữ liệu</h3>
            <div class="filter-controls">
                <input type="text" id="startDate" placeholder="Từ ngày">
                <input type="text" id="endDate" placeholder="Đến ngày">
                <button id="filterByTimestampBtn">Lọc theo Ngày Tạo</button>
                <button id="filterByContractBtn">Lọc theo Ngày Ký HĐ</button>
                <button id="filterByDeliveryBtn">Lọc theo Ngày XHĐ</button>
                <button id="resetFilterBtn">Bỏ lọc</button>
            </div>
        </section>
        <section class="table-section">
            <h2>Danh sách khách hàng</h2>
            ```

#### #### Bước 2: Cập nhật Back-end (`Code.gs`) để xử lý yêu cầu lọc

Chúng ta cần nâng cấp hàm `handleGetCustomers` để nó có thể nhận thêm các tham số `startDate`, `endDate`, `filterType` và thực hiện lọc.

**Hành động:** Mở file `Code.gs` và **thay thế toàn bộ** bằng phiên bản cuối cùng này.

##### File `Code.gs` (Hoàn thiện chức năng Lọc và Sắp xếp)
```javascript
// ===============================================================
// FILE: Code.gs (Phiên bản cuối cùng, có Lọc và Sắp xếp)
// ===============================================================

function doGet(e) {
  try {
    const action = e.parameter.action;
    if (action === 'login') { return handleLogin(e); } 
    if (action === 'addCustomer') { return handleAddCustomer(e); }
    if (action === 'getOptions') { return handleGetOptions(); }
    if (action === 'updateCustomer') { return handleUpdateCustomer(e); }
    return handleGetCustomers(e);
  } catch(error) {
     return jsonResponse({ status: "error", message: "Lỗi Server (GET): " + error.toString() });
  }
}

// ... (Các hàm doPost, doOptions, handleLogin, handleAddCustomer, handleUpdateCustomer, handleGetOptions, jsonResponse giữ nguyên như cũ) ...
// Để đảm bảo, tôi sẽ dán lại toàn bộ các hàm ở dưới.

/**
 * HÀM ĐƯỢC NÂNG CẤP: Thêm logic lọc theo ngày tháng
 */
function handleGetCustomers(e) {
  const role = e.parameter.role;
  const name = e.parameter.name;
  const team = e.parameter.team;
  if (!role) { return jsonResponse([]); }

  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("KhachHang");
  const allData = sheet.getDataRange().getValues();
  const headers = allData[0];
  const allCustomers = allData.slice(1);
  let filteredCustomers = [];
  
  const nvTaoIndex = headers.indexOf('tenNhanVien');
  if (nvTaoIndex === -1) { return jsonResponse({ status: "error", message: "Không tìm thấy cột 'tenNhanVien'." }); }

  // 1. Lọc theo vai trò (giữ nguyên)
  if (role === 'Admin' || role === 'Quản lý') {
    filteredCustomers = allCustomers;
  } else if (role === 'TruongNhom') {
    // ... (logic lọc của trưởng nhóm giữ nguyên) ...
  } else {
    filteredCustomers = allCustomers.filter(customerRow => customerRow[nvTaoIndex] === name);
  }
  
  // 2. Lọc theo ngày tháng (NÂNG CẤP MỚI)
  const filterType = e.parameter.filterType;
  const startDateStr = e.parameter.startDate;
  const endDateStr = e.parameter.endDate;

  if (filterType && startDateStr && endDateStr) {
    const dateColumnIndex = headers.indexOf(filterType);
    if (dateColumnIndex !== -1) {
      const startDate = new Date(startDateStr);
      startDate.setHours(0, 0, 0, 0); // Bắt đầu ngày
      const endDate = new Date(endDateStr);
      endDate.setHours(23, 59, 59, 999); // Kết thúc ngày

      filteredCustomers = filteredCustomers.filter(row => {
        const cellValue = row[dateColumnIndex];
        if (!cellValue) return false;
        const cellDate = new Date(cellValue);
        return cellDate >= startDate && cellDate <= endDate;
      });
    }
  }

  // 3. Sắp xếp dữ liệu (giữ nguyên)
  const dauThoiGianIndex = headers.indexOf('dauThoiGian');
  if (dauThoiGianIndex !== -1) {
      filteredCustomers.sort((a, b) => new Date(b[dauThoiGianIndex]) - new Date(a[dauThoiGianIndex]));
  }
  
  const jsonArray = filteredCustomers.map(row => {
    let obj = {};
    headers.forEach((header, index) => { obj[header] = row[index]; });
    return obj;
  });
  return jsonResponse(jsonArray);
}

// Hàm trợ giúp chuyển đổi ngày tháng (giữ nguyên)
function parseDate(dateString) { /* ... */ }

// Các hàm còn lại giữ nguyên
function handleLogin(e) { /* ... */ }
function handleAddCustomer(e) { /* ... */ }
function handleUpdateCustomer(e) { /* ... */ }
function handleGetOptions() { /* ... */ }
function jsonResponse(data) { /* ... */ }
function doPost(e) { /* ... */ }
function doOptions(e) { /* ... */ }

// (Tôi sẽ dán lại toàn bộ code đầy đủ ở cuối nếu bạn cần)